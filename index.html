<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Sheets</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;600&display=swap');

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, "San Francisco", "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(180deg, #f5f5f7 0%, #ffffff 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #1d1d1f;
            padding: 20px;
        }

        .motherbox {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 18px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 380px;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .motherbox:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        h1 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #1d1d1f;
        }

        .info-section {
            margin-bottom: 20px;
        }

        .calculator-section {
            margin-bottom: 40px;
        }

        .input-group {
            margin: 10px 0; /* Consistent margin for all input groups */
            text-align: left;
        }

        label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #1d1d1f;
            margin-bottom: 6px;
        }

        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d2d2d7;
            border-radius: 10px;
            font-size: 16px;
            background-color: #f5f5f7;
            box-sizing: border-box;
            transition: border-color 0.2s ease;
        }

        input:focus {
            outline: none;
            border-color: #007aff;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2);
        }

        .input-with-suffix {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-with-suffix input {
            padding-right: 30px;
        }

        .input-with-suffix .suffix {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            font-weight: 500;
            color: #6e6e73;
            pointer-events: none;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-with-suffix input[type="number"] {
            position: relative;
        }

        /* Grid layout for calculator inputs */
        .calculator-columns {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Two equal columns */
            gap: 20px; /* Space between columns */
            width: 100%; /* Match the width of the motherbox content */
        }

        .column {
            display: flex;
            flex-direction: column;
        }

        .result {
            margin-top: 20px;
            text-align: left;
        }

        .result h3 {
            font-size: 18px;
            font-weight: 600;
            color: #1d1d1f;
            margin: 0 0 10px 0;
        }

        .result-box {
            background-color: #f5f5f7;
            padding: 12px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        #og-value, #calorie-value, #corrected-sg-value, #corrected-p-value {
            font-size: 18px;
            font-weight: 500;
            color: #007aff;
            margin: 0;
            line-height: 1.4;
        }

        @media (max-width: 820px) {
            .motherbox {
                padding: 30px;
                width: 100%;
                max-width: 380px;
            }

            h1 {
                font-size: 24px;
            }

            label {
                font-size: 12px;
            }

            input {
                font-size: 14px;
            }

            .input-with-suffix .suffix {
                font-size: 14px;
            }

            .calculator-columns {
                gap: 15px; /* Slightly smaller gap on smaller screens */
            }

            .result h3 {
                font-size: 16px;
            }

            #og-value, #calorie-value, #corrected-sg-value, #corrected-p-value {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="motherbox">
        <h1>Technical Sheets</h1>
        
        <!-- New Info Section -->
        <div class="info-section">
            <div class="input-group">
                <label for="date">Date</label>
                <input type="date" id="date">
            </div>
            <div class="input-group">
                <label for="beer">Beer</label>
                <input type="text" id="beer" placeholder="e.g., Omnipollo Fatamorgana 8% 33cl">
            </div>
            <div class="input-group">
                <label for="beer-style">Beer Style</label>
                <input type="text" id="beer-style" placeholder="e.g., Double India Pale Ale">
            </div>
        </div>

        <!-- Combined Calculator Section -->
        <div class="calculator-section">
            <div class="calculator-columns">
                <div class="column">
                    <div class="input-group">
                        <label for="av">ABV</label>
                        <div class="input-with-suffix">
                            <input type="number" id="av" step="0.01" placeholder="e.g., 5.5" required>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="fg">Final Gravity</label>
                        <div class="input-with-suffix">
                            <input type="number" id="fg" step="0.001" placeholder="e.g., 1.010" required>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <div class="input-group">
                        <label for="volume">Volume</label>
                        <div class="input-with-suffix">
                            <input type="text" id="volume" placeholder="e.g., 33">
                            <span class="suffix">cl</span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="celsiusInput">Product Temperature in °C</label>
                        <div class="input-with-suffix">
                            <input type="number" id="celsiusInput" placeholder="e.g., 20">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="result">
                <h3>Results</h3>
                <div class="result-box">
                    <p id="og-value">Enter values to see OG</p>
                    <p id="calorie-value">Enter values to see Calories</p>
                    <p id="corrected-sg-value">Enter temperature and SG to see Corrected SG</p>
                    <p id="corrected-p-value"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Function to update ABV and Volume from Beer input
        function updateFieldsFromBeer() {
            const beerInput = document.getElementById('beer').value;
            const abvInput = document.getElementById('av');
            const volumeInput = document.getElementById('volume');
            
            // Update ABV: Extract number before '%'
            const abvMatch = beerInput.match(/(\d*\.?\d+)%/);
            if (abvMatch) {
                const abvValue = parseFloat(abvMatch[1]);
                abvInput.value = abvValue;
            } else {
                abvInput.value = '';
            }

            // Update Volume: Extract number before 'cl'
            const volumeMatch = beerInput.match(/(\d*\.?\d+)cl/);
            if (volumeMatch) {
                const volumeValue = volumeMatch[1];
                volumeInput.value = volumeValue;
            } else {
                volumeInput.value = '';
            }

            // Trigger calculations after updating fields
            calculateAll();
        }

        // Calculation function
        function calculateAll() {
            const fg = parseFloat(document.getElementById('fg').value);
            const av = parseFloat(document.getElementById('av').value);
            const celsius = parseFloat(document.getElementById('celsiusInput').value);
            const volume = parseFloat(document.getElementById('volume').value) || 33;

            // OG and Calorie Calculation
            if (!isNaN(fg) && !isNaN(av)) {
                const a = 76.08;
                const b = 0.794;
                const c = 1.775;

                const numerator = (av * b * c) + (a * fg * fg);
                const denominator = (a * fg) + (av * b);
                const og = numerator / denominator;

                const calorieContent = (3621 * fg * (
                    (0.8114 * fg + 0.1886 * og - 1) + 
                    0.53 * ((og - fg) / (1.775 - og))
                ) * volume / 33);

                document.getElementById('og-value').innerText = `OG: ${og.toFixed(3)}`;
                document.getElementById('calorie-value').innerText = `Calories: ${calorieContent.toFixed(0)} cal`;
            } else {
                document.getElementById('og-value').innerText = "Please enter FG and ABV for OG.";
                document.getElementById('calorie-value').innerText = "Please enter FG and ABV for Calories.";
            }

            // Corrected SG Calculation
            if (!isNaN(celsius) && !isNaN(fg)) {
                const fahrenheit = (celsius * 9/5) + 32;
                const X = fahrenheit;
                const sgcf = 1.00130346 - 
                            (1.34722124 * Math.pow(10, -4) * X) + 
                            (2.04052596 * Math.pow(10, -6) * Math.pow(X, 2)) - 
                            (2.32820948 * Math.pow(10, -9) * Math.pow(X, 3));
                const Y = sgcf;
                const multipliedY = Y * 1000;
                const sgcfPoints = multipliedY % 1000;
                const Z = fg;
                const multipliedZ = Z * 1000;
                const observedSGPoints = multipliedZ % 1000;
                const correctedSGPoints = observedSGPoints + (sgcfPoints - 1);
                const correctedSG = (correctedSGPoints / 1000) + 1;
                const correctedP = 1000 * (correctedSG - 1) / 4;

                document.getElementById('corrected-sg-value').innerText = `Corrected SG: ${correctedSG.toFixed(0)}`;
                document.getElementById('corrected-p-value').innerText = `Corrected °P: ${correctedP.toFixed(3)}`;
            } else {
                document.getElementById('corrected-sg-value').innerText = "Please enter temperature and FG for Corrected SG.";
                document.getElementById('corrected-p-value').innerText = "";
            }
        }

        // Add event listeners for real-time updates
        document.getElementById('beer').addEventListener('input', updateFieldsFromBeer);
        document.getElementById('fg').addEventListener('input', calculateAll);
        document.getElementById('av').addEventListener('input', calculateAll);
        document.getElementById('celsiusInput').addEventListener('input', calculateAll);
        document.getElementById('volume').addEventListener('input', calculateAll);

        // Initial calculation on page load
        calculateAll();
    </script>
</body>
</html>
